<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>ç­ç´šæ•¸ä½å¹³å° v3.3.1</title>

    <meta name="theme-color" id="chrome-theme" content="#f8fafc">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" id="safari-theme" content="default">

    <script>
        (function() {
            const theme = localStorage.getItem('theme') || 'light';
            const layout = localStorage.getItem('layout') || 'list-mode';
            const lastPage = localStorage.getItem('lastPage') || '0';

            if (theme === 'dark') document.documentElement.classList.add('dark-mode');
            document.documentElement.setAttribute('data-layout', layout);
            document.documentElement.setAttribute('data-init-page', lastPage);
            
            const gateStyle = document.createElement('style');
            gateStyle.innerHTML = `body { opacity: 0; } [data-system-ready="true"] body { opacity: 1; transition: opacity 0.3s ease; }`;
            document.head.appendChild(gateStyle);
        })();

        // ğŸ—ï¸ å®Œæ•´ä¿ç•™æ‚¨çš„å…¨åŸŸé…ç½®
        const SYS_CONFIG = {
            banner: "è¨±é¡˜æ± ç³»çµ±è² è¼‰è¼ƒé«˜ï¼Œè«‹ç¯€çœé »ç‡ä»¥ç¶­æŒå…¶ä»–æœå‹™æ­£å¸¸ã€‚",
            author: {
                name: "ç‹å®¥éˆ",
                role: "é–‹ç™¼è€… ï½œ Developer",
                ver: "v3.3.1(App-Beta)",
                docUrl: "#",
                updates: [
                    "- æ ¸å¿ƒå‡ç´šï¼šæ¡ç”¨ SPA å®¹å™¨æ¶æ§‹ï¼Œè§£æ±º Safari åŠ å…¥ä¸»ç•«é¢å¾Œçš„ç¶²å€åˆ—å•é¡Œã€‚",
                    "- ä½ˆå±€å„ªåŒ–ï¼šé©é… iOS Safe Areaï¼Œè§£æ±ºé ‚éƒ¨ç‹€æ…‹åˆ—é®æ“‹å•é¡Œã€‚",
                    "- æ²‰æµ¸é«”é©—ï¼šæ‰€æœ‰å·¥å…·å‡åœ¨ App å…§é–‹å•Ÿï¼Œç¶­æŒç’°å¢ƒä¸€è‡´æ€§ã€‚",
                    "- å¼·åŒ–æ·±è‰²æ¨¡å¼æŒ‰éˆ•é«˜å°æ¯”é¡¯ç¤ºï¼Œå„ªåŒ–ä½¿ç”¨é«”é©—ã€‚",
                    "- ä¿®æ­£é‡æ–°æ•´ç†å¾Œ Page Index åç§»å•é¡Œã€‚"
                ]
            }
        };
    </script>

    <style>
        :root {
            --p: #4361ee; --p-light: rgba(67, 97, 238, 0.1); --g: #7209b7; 
            --bg: #f8fafc; --card: #ffffff; --text: #1e293b; --sub: #64748b; 
            --border: rgba(0,0,0,0.08); --nav-bg: rgba(255, 255, 255, 0.85); 
            --banner-bg: #fff9db; --banner-text: #856404;
            --accent: #4361ee;
            --safe-top: env(safe-area-inset-top, 20px);
            --safe-bottom: env(safe-area-inset-bottom, 20px);
        }

        .dark-mode {
            --bg: #020617; --card: #111827; --text: #f8fafc; --sub: #94a3b8; 
            --border: rgba(255,255,255,0.1); --nav-bg: rgba(15, 23, 42, 0.85); 
            --banner-bg: #1e1b0a; --banner-text: #ffe066; --accent: #fbbf24;
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body {
            margin: 0; padding: 0; width: 100vw; height: 100dvh;
            background-color: var(--bg); color: var(--text);
            font-family: 'PingFang TC', 'Microsoft JhengHei', sans-serif;
            overflow: hidden; position: fixed;
        }

        /* ğŸ“¢ è§£æ±ºé®æ“‹ï¼šåŠ å…¥ Safe Area å¡«å…… */
        .top-notice {
            background: var(--banner-bg); color: var(--banner-text);
            padding: calc(var(--safe-top) + 5px) 15px 8px; 
            font-size: 13px; text-align: center; font-weight: 700; border-bottom: 1px solid var(--border);
            white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
        }

        header {
            height: 72px; padding: 0 20px;
            background: var(--nav-bg); backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px);
            border-bottom: 1px solid var(--border);
            display: flex; justify-content: space-between; align-items: center; z-index: 1000;
        }

        .brand h1 { margin: 0; font-size: 20px; font-weight: 900; color: var(--p); letter-spacing: -0.5px; }
        .brand p { margin: 0; font-size: 10px; color: var(--sub); font-weight: 800; letter-spacing: 1.2px; text-transform: uppercase; }

        .controls { display: flex; gap: 10px; align-items: center; }
        .toggle-group { display: flex; background: rgba(0,0,0,0.08); padding: 4px; border-radius: 14px; gap: 4px; border: 1px solid var(--border); }
        .dark-mode .toggle-group { background: rgba(255,255,255,0.06); }

        .icon-btn {
            border: none; background: transparent; cursor: pointer;
            width: 40px; height: 34px; border-radius: 10px;
            display: flex; align-items: center; justify-content: center;
            color: var(--sub); transition: all 0.3s;
        }

        .icon-btn.active { background: var(--p); color: #ffffff !important; box-shadow: 0 4px 12px rgba(67, 97, 238, 0.4); }
        .dark-mode .icon-btn.active { background: var(--accent); color: #000000 !important; box-shadow: 0 0 15px rgba(251, 191, 36, 0.3); }

        .circle-tool { width: 42px; height: 42px; border-radius: 50%; background: var(--card); border: 1px solid var(--border); display: flex; align-items: center; justify-content: center; }
        svg { width: 20px; height: 20px; fill: none; stroke: currentColor; stroke-width: 2.5; stroke-linecap: round; stroke-linejoin: round; }

        /* ğŸ“– è¦–çª—å¼•æ“ */
        .viewport {
            width: 100%; height: calc(100dvh - 72px - 112px); /* æ‰£é™¤ Header èˆ‡ Notice */
            display: flex; overflow-x: auto; scroll-snap-type: x mandatory;
            scrollbar-width: none; -webkit-overflow-scrolling: touch;
        }
        .viewport::-webkit-scrollbar { display: none; }
        .page-panel { flex: 0 0 100%; width: 100%; height: 100%; scroll-snap-align: start; overflow-y: auto; padding: 25px 20px 180px; }

        .content-grid { display: grid; gap: 18px; width: 100%; max-width: 1100px; margin: 0 auto; }
        [data-layout="list-mode"] .card { padding: 22px; display: flex; align-items: center; }
        [data-layout="grid-mode"] .content-grid { grid-template-columns: repeat(3, 1fr); gap: 12px; }
        [data-layout="grid-mode"] .card { flex-direction: column; padding: 20px 10px; text-align: center; }

        .card { background: var(--card); border: 1px solid var(--border); border-radius: 24px; color: inherit; transition: 0.3s; cursor: pointer; }
        .card:active { transform: scale(0.96); background: var(--p-light); }
        .card-icon { display: flex; align-items: center; justify-content: center; background: var(--p-light); color: var(--p); width: 56px; height: 56px; border-radius: 16px; font-size: 24px; }
        [data-layout="list-mode"] .card-icon { margin-right: 20px; }
        [data-layout="grid-mode"] .card-icon { margin: 0 auto 12px; width: 48px; height: 48px; border-radius: 50%; }

        /* ğŸ§­ åº•éƒ¨å°è¦½åˆ— */
        .nav-dock { position: fixed; bottom: calc(25px + var(--safe-bottom)); left: 50%; transform: translateX(-50%); width: 92%; max-width: 440px; z-index: 5000; }
        .nav-glass { background: var(--nav-bg); backdrop-filter: blur(25px); -webkit-backdrop-filter: blur(25px); display: flex; padding: 6px; border-radius: 100px; border: 1px solid var(--border); box-shadow: 0 15px 40px rgba(0,0,0,0.2); }
        .nav-item { flex: 1; text-align: center; padding: 14px 0; font-size: 14px; font-weight: 900; color: var(--sub); border-radius: 100px; transition: 0.4s; }
        .nav-item.active { color: #ffffff; background: var(--p); box-shadow: 0 8px 20px rgba(67, 97, 238, 0.3); }

        /* ğŸ–ï¸ å®Œæ•´ä¿ç•™æ‚¨çš„è³‡è¨Šå½ˆçª— */
        .overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.85); backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px); z-index: 9999; display: none; align-items: center; justify-content: center; padding: 25px; }
        .overlay.active { display: flex; }
        .modal { background: var(--bg); width: 100%; max-width: 360px; border-radius: 35px; overflow: hidden; border: 1px solid var(--border); animation: modalPop 0.4s cubic-bezier(0.17, 0.89, 0.32, 1.28); }
        @keyframes modalPop { from { opacity: 0; transform: scale(0.9) translateY(40px); } to { opacity: 1; transform: scale(1) translateY(0); } }
        .modal-header { background: linear-gradient(135deg, var(--p), var(--g)); color: white; padding: 40px 25px; text-align: center; }
        .avatar { width: 70px; height: 70px; background: rgba(255,255,255,0.2); border: 3px solid #ffffff; border-radius: 50%; margin: 0 auto 15px; display: flex; align-items: center; justify-content: center; font-size: 30px; font-weight: 900; }
        .changelog { background: rgba(0,0,0,0.04); border: 1px solid var(--border); border-radius: 20px; padding: 20px; height: 160px; overflow-y: auto; font-size: 13px; line-height: 1.8; color: var(--sub); }
        .close-btn { width: 100%; padding: 18px; background: var(--text); color: var(--bg); border: none; border-radius: 22px; font-weight: 900; margin-top: 25px; }

        /* ğŸ“º æ²‰æµ¸å¼å·¥å…·å®¹å™¨ */
        #tool-view { position: fixed; inset: 0; background: var(--bg); z-index: 10000; transform: translateY(100%); transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1); display: flex; flex-direction: column; }
        #tool-view.active { transform: translateY(0); }
        .tool-bar { padding: calc(var(--safe-top) + 10px) 20px 10px; background: var(--card); display: flex; align-items: center; border-bottom: 1px solid var(--border); }
        iframe { flex: 1; border: none; width: 100%; height: 100%; }
    </style>
</head>
<body data-layout="list-mode">

    <div class="top-notice" id="ui-banner"></div>

    <header>
        <div class="brand"><h1>ç­ç´šæ•¸ä½å¹³å°</h1><p>Digital Classroom System</p></div>
        <div class="controls">
            <div class="toggle-group">
                <button class="icon-btn" id="listToggle" onclick="App.updateLayout('list-mode')"><svg viewBox="0 0 24 24"><line x1="8" y1="6" x2="21" y2="6"/><line x1="8" y1="12" x2="21" y2="12"/><line x1="8" y1="18" x2="21" y2="18"/><path d="M3 6h.01M3 12h.01M3 18h.01"/></svg></button>
                <button class="icon-btn" id="gridToggle" onclick="App.updateLayout('grid-mode')"><svg viewBox="0 0 24 24"><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/></svg></button>
            </div>
            <button class="icon-btn circle-tool" onclick="App.updateTheme()"><svg id="theme-icon" viewBox="0 0 24 24"></svg></button>
            <button class="icon-btn circle-tool" onclick="App.showInfo(true)"><svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><line x1="12" y1="16" x2="12" y2="12"/><line x1="12" y1="8" x2="12.01" y2="8"/></svg></button>
        </div>
    </header>

    <main class="viewport" id="scroll-engine">
        <section class="page-panel"><div class="content-grid">
            <div class="card" onclick="App.openTool('è¡Œäº‹æ›†/index.html', 'ç­ç´šè¡Œäº‹æ›†')"><div class="card-icon">ğŸ“…</div><div class="card-info"><h2>ç­ç´šè¡Œäº‹æ›†</h2><p>æŒæ¡è€ƒç¨‹èˆ‡é‡è¦æ´»å‹•</p></div></div>
            <div class="card" onclick="App.openTool('countdown/index.html', 'è€ƒç¨‹å€’æ•¸')"><div class="card-icon">â³</div><div class="card-info"><h2>è€ƒç¨‹å€’æ•¸</h2><p>å€’æ•¸æ®µè€ƒèˆ‡çµ±æ¸¬</p></div></div>
            <div class="card" onclick="App.openTool('homework/index.html', 'ä½œæ¥­å¾…è¾¦')"><div class="card-icon">ğŸ“’</div><div class="card-info"><h2>ä½œæ¥­å¾…è¾¦</h2><p>å³æ™‚æŸ¥çœ‹ä¸éºæ¼</p></div></div>
        </div></section>

        <section class="page-panel"><div class="content-grid">
            <div class="card" onclick="App.openTool('help/student.html', 'åŒ¿åæ±‚åŠ©')"><div class="card-icon">ğŸŒ±</div><div class="card-info"><h2>åŒ¿åæ±‚åŠ©</h2><p>åŒ¿åæ±‚åŠ©å°å¸«</p></div></div>
            <div class="card" onclick="App.openTool('unknownmail/index.html', 'åŒ¿åä¿¡ç®±')"><div class="card-icon">âœ‰ï¸</div><div class="card-info"><h2>åŒ¿åä¿¡ç®±</h2><p>å‚³é€æé†’çµ¦åŒå­¸</p></div></div>
            <div class="card" onclick="App.openTool('åŒ¿å/index.html', 'åŒ¿åè¨±é¡˜æ± ')"><div class="card-icon">âœ¨</div><div class="card-info"><h2>åŒ¿åè¨±é¡˜æ± </h2><p>è®“ç­ç´šæ›´ç¾å¥½çš„é»å­</p></div></div>
        </div></section>

        <section class="page-panel"><div class="content-grid">
            <div class="card" onclick="App.openTool('cleaning/index.html', 'æ‰“æƒå‹¤å‹™')"><div class="card-icon">ğŸ§¹</div><div class="card-info"><h2>æ‰“æƒå‹¤å‹™</h2><p>æŸ¥çœ‹æƒå€é»æ•¸</p></div></div>
            <div class="card" onclick="App.openTool('seating/index.html', 'é¸ä½ç³»çµ±')"><div class="card-icon">ğŸª‘</div><div class="card-info"><h2>é¸ä½ç³»çµ±</h2><p>éš¨æ©Ÿç”Ÿæˆåº§ä½è¡¨</p></div></div>
            <div class="card" onclick="App.openTool('vote/index.html', 'æ•¸ä½æŠ•ç¥¨')"><div class="card-icon">ğŸ—³ï¸</div><div class="card-info"><h2>æ•¸ä½æŠ•ç¥¨</h2><p>å³æ™‚è¡¨æ±ºç­å‹™</p></div></div>
        </div></section>

        <section class="page-panel"><div class="content-grid">
            <div class="card" onclick="App.openTool('exam_calc/index.html', 'æ®µè€ƒåŠ æ¬Š')"><div class="card-icon">ğŸ“</div><div class="card-info"><h2>æ®µè€ƒåŠ æ¬Š</h2><p>è¨ˆç®—å¹³å‡èˆ‡ç¸½åˆ†</p></div></div>
            <div class="card" onclick="App.openTool('final_calc/index.html', 'å­¸æœŸç¸½åˆ†')"><div class="card-icon">ğŸ“ˆ</div><div class="card-info"><h2>å­¸æœŸç¸½åˆ†</h2><p>åˆ¤æ–·é€šéè£œè€ƒ</p></div></div>
        </div></section>
    </main>

    <nav class="nav-dock">
        <div class="nav-glass">
            <div class="nav-item" onclick="App.moveTo(0)">æé†’</div>
            <div class="nav-item" onclick="App.moveTo(1)">äº’å‹•</div>
            <div class="nav-item" onclick="App.moveTo(2)">ç­å‹™</div>
            <div class="nav-item" onclick="App.moveTo(3)">æˆç¸¾</div>
        </div>
    </nav>

    <div class="overlay" id="ui-overlay">
        <div class="modal">
            <div class="modal-header"><div class="avatar">ç‹</div><h3 id="author-name" style="margin:0"></h3><p id="author-title" style="margin:5px 0 0; font-size:12px; opacity:0.8"></p></div>
            <div class="modal-content" style="padding:30px;">
                <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;">
                    <span id="sys-ver" style="background:var(--p); color:white; padding:6px 12px; border-radius:10px; font-size:12px; font-weight:800;"></span>
                    <a href="#" id="sys-doc" style="color:var(--p); font-weight:900; text-decoration:none; font-size:14px;">ä½¿ç”¨æ•™å­¸</a>
                </div>
                <div class="changelog" id="sys-logs"></div>
                <button class="close-btn" onclick="App.showInfo(false)">é—œé–‰</button>
            </div>
        </div>
    </div>

    <div id="tool-view">
        <div class="tool-bar">
            <button onclick="App.closeTool()" style="border:none; background:none; font-weight:900; color:var(--p); font-size:16px;">âœ• é—œé–‰å·¥å…·</button>
            <div id="tool-title" style="flex:1; text-align:center; font-weight:800;"></div>
            <div style="width:70px;"></div>
        </div>
        <iframe id="tool-iframe" src=""></iframe>
    </div>

    <script>
        const App = {
            dom: {
                scroller: document.getElementById('scroll-engine'),
                tabs: document.querySelectorAll('.nav-item'),
                themeIcon: document.getElementById('theme-icon'),
                chromeMeta: document.getElementById('chrome-theme'),
                safariMeta: document.getElementById('safari-theme')
            },
            state: {
                currentIdx: parseInt(localStorage.getItem('lastPage')) || 0,
                isDark: document.documentElement.classList.contains('dark-mode'),
                layout: localStorage.getItem('layout') || 'list-mode'
            },
            init() {
                document.getElementById('ui-banner').innerText = SYS_CONFIG.banner;
                this.updateLayout(this.state.layout);
                this.syncSystemUI();
                setTimeout(() => {
                    this.moveTo(this.state.currentIdx, 'auto');
                    document.documentElement.setAttribute('data-system-ready', 'true');
                }, 50);
                this.bind();
            },
            moveTo(idx, behavior = 'smooth') {
                this.dom.scroller.scrollTo({ left: idx * this.dom.scroller.offsetWidth, behavior });
                this.state.currentIdx = idx;
                localStorage.setItem('lastPage', idx);
                this.dom.tabs.forEach((t, i) => t.classList.toggle('active', i === idx));
            },
            updateLayout(mode) {
                document.documentElement.setAttribute('data-layout', mode);
                this.state.layout = mode;
                localStorage.setItem('layout', mode);
                document.getElementById('listToggle').classList.toggle('active', mode === 'list-mode');
                document.getElementById('gridToggle').classList.toggle('active', mode === 'grid-mode');
                setTimeout(() => this.moveTo(this.state.currentIdx, 'auto'), 60);
            },
            updateTheme() {
                this.state.isDark = !this.state.isDark;
                document.documentElement.classList.toggle('dark-mode', this.state.isDark);
                localStorage.setItem('theme', this.state.isDark ? 'dark' : 'light');
                this.syncSystemUI();
            },
            syncSystemUI() {
                const color = this.state.isDark ? "#020617" : "#f8fafc";
                this.dom.chromeMeta.content = color;
                this.dom.safariMeta.content = this.state.isDark ? "black-translucent" : "default";
                this.dom.themeIcon.innerHTML = this.state.isDark 
                    ? `<circle cx="12" cy="12" r="5" fill="currentColor"/><path d="M12 1v2m0 18v2M4.22 4.22l1.42 1.42m12.72 12.72l1.42 1.42M1 12h2m18 0h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42" stroke="currentColor"/>`
                    : `<path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z" fill="currentColor" stroke="currentColor"/>`;
            },
            showInfo(active) {
                const overlay = document.getElementById('ui-overlay');
                if (active) {
                    document.getElementById('author-name').innerText = SYS_CONFIG.author.name;
                    document.getElementById('author-title').innerText = SYS_CONFIG.author.role;
                    document.getElementById('sys-ver').innerText = SYS_CONFIG.author.ver;
                    document.getElementById('sys-doc').href = SYS_CONFIG.author.docUrl;
                    document.getElementById('sys-logs').innerHTML = SYS_CONFIG.author.updates.join('<br>');
                    overlay.classList.add('active');
                } else overlay.classList.remove('active');
            },
            openTool(url, title) {
                document.getElementById('tool-title').innerText = title;
                document.getElementById('tool-iframe').src = url;
                document.getElementById('tool-view').classList.add('active');
            },
            closeTool() {
                document.getElementById('tool-view').classList.remove('active');
                setTimeout(() => { document.getElementById('tool-iframe').src = ''; }, 400);
            },
            bind() {
                this.dom.scroller.addEventListener('scroll', () => {
                    const idx = Math.round(this.dom.scroller.scrollLeft / this.dom.scroller.offsetWidth);
                    if (idx !== this.state.currentIdx) {
                        this.state.currentIdx = idx;
                        localStorage.setItem('lastPage', idx);
                        this.dom.tabs.forEach((t, i) => t.classList.toggle('active', i === idx));
                    }
                }, { passive: true });
                window.addEventListener('resize', () => this.moveTo(this.state.currentIdx, 'auto'));
            }
        };
        window.addEventListener('DOMContentLoaded', () => App.init());
    </script>
</body>
</html>
