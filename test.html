<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>çµ‚æ¥µæ„Ÿå®˜æ•¸ä½å¹³å° v20.0</title>

    <meta name="theme-color" id="meta-chrome" content="#f8fafc">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" id="meta-safari" content="default">

    <script>
        (function() {
            const cfg = {
                t: localStorage.getItem('theme') || 'light',
                l: localStorage.getItem('layout') || 'list-mode',
                p: localStorage.getItem('page') || '0'
            };
            // é æ¸²æŸ“é–å®š
            if (cfg.t === 'dark') document.documentElement.classList.add('dark-mode');
            document.documentElement.setAttribute('data-layout', cfg.l);
            document.documentElement.setAttribute('data-init-page', cfg.p);
            
            // å»ºç«‹å±éšœæ¨£å¼
            const css = document.createElement('style');
            css.innerHTML = `body { opacity: 0; visibility: hidden; } [data-ready="true"] body { opacity: 1; visibility: visible; transition: opacity 0.4s ease; }`;
            document.head.appendChild(css);
        })();

        // ğŸ–ï¸ å…¨åŸŸé…ç½®æ•¸æ“š
        const APP_MANIFEST = {
            title: "èè‹±ç­ç´šå¹³å° v20",
            announcement: "ğŸšï¸ v20.0 å·²éƒ¨ç½²ï¼šå°å…¥åŸç”Ÿæ‹‰æ¡¿æ¨¡æ“¬æŠ€è¡“ï¼Œå¼·åŒ–å®‰å“ç¡¬é«”éœ‡å‹•èˆ‡æ·±è‰²å°æ¯”ã€‚",
            author: "ç‹å®¥éˆ (Lead Architect)",
            version: "20.0.1-Stable-Haptic",
            changelog: [
                "1. å¯¦ä½œã€Œè™›æ“¬åŸç”Ÿçµ„ä»¶ã€ï¼šæ¨¡æ“¬æ‹‰æ¡¿æ’¥å‹•ä»¥èª˜ç™¼åº•å±¤éœ‡å‹•å›é¥‹ã€‚",
                "2. å°å…¥ã€ŒæŒ‡å°–é˜²æŠ–ã€ï¼šé˜²æ­¢å¿«é€Ÿé€£çºŒé»æ“Šé€ æˆçš„ä»‹é¢è·³å‹•ã€‚",
                "3. å¼·åŒ–ç¥ç€é‡‘ä»‹é¢ï¼šæ·±è‰²æ¨¡å¼ä¸‹é¸ä¸­ç‹€æ…‹å°æ¯”åº¦æå‡ 300%ã€‚",
                "4. åº§æ¨™å®ˆè­·æŠ€è¡“ï¼šè§£æ±ºé‡æ–°æ•´ç†å¾Œ Page Index è‡ªå‹•æ­¸é›¶çš„é ‘ç–¾ã€‚"
            ]
        };
    </script>

    <style>
        /* =============================================
           ğŸ¨ 1. è¦–è¦ºæ ¸å¿ƒç³»çµ± (é«˜é®®è‰·å°æ¯”)
           ============================================= */
        :root {
            --p: #4361ee; --p-bg: rgba(67, 97, 238, 0.1); --bg: #f8fafc; --card: #ffffff;
            --text: #1e293b; --sub: #64748b; --border: rgba(0,0,0,0.1);
            --nav: rgba(255, 255, 255, 0.85); --banner-bg: #fff9db; --banner-text: #856404;
            --indicator: #4361ee; /* æ·ºè‰²é¸ä¸­ï¼šè— */
            --safe-bottom: env(safe-area-inset-bottom, 20px);
        }

        .dark-mode {
            --bg: #020617; --card: #0f172a; --text: #f8fafc;
            --sub: #94a3b8; --border: rgba(255,255,255,0.12);
            --nav: rgba(15, 23, 42, 0.85); --banner-bg: #1e1b0a; --banner-text: #ffe066;
            --indicator: #fbbf24; /* æ·±è‰²é¸ä¸­ï¼šç¥ç€é‡‘ (æ¥µé†’ç›®) */
        }

        /* =============================================
           ğŸ—ï¸ 2. åŸºç¤ä½ˆå±€è¦ç¯„
           ============================================= */
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body {
            margin: 0; padding: 0; width: 100vw; height: 100dvh;
            background-color: var(--bg); color: var(--text);
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "PingFang TC", sans-serif;
            overflow: hidden; position: fixed; touch-action: none;
        }

        /* é ‚éƒ¨æ©«å¹… */
        .banner {
            padding: 10px 15px; font-size: 13px; text-align: center; font-weight: 800;
            background: var(--banner-bg); color: var(--banner-text); border-bottom: 1px solid var(--border);
        }

        /* æ¨™é ­ä»‹é¢ */
        header {
            height: 72px; padding: 0 20px; display: flex; justify-content: space-between; align-items: center;
            background: var(--nav); backdrop-filter: blur(25px); -webkit-backdrop-filter: blur(25px);
            border-bottom: 1px solid var(--border); z-index: 1000;
        }
        .brand h1 { margin: 0; font-size: 20px; font-weight: 900; color: var(--p); letter-spacing: -1px; }
        .brand p { margin: 0; font-size: 10px; color: var(--sub); font-weight: 800; text-transform: uppercase; }

        /* æŒ‰éˆ•çµ„ï¼šå¼·åŒ–é¸ä¸­è¦–è¦ºæ„Ÿ */
        .controls { display: flex; gap: 10px; align-items: center; }
        .sw-group { display: flex; background: rgba(0,0,0,0.06); padding: 4px; border-radius: 14px; border: 1px solid var(--border); }
        .dark-mode .sw-group { background: rgba(255,255,255,0.05); }

        .btn-icon {
            border: none; background: transparent; cursor: pointer;
            width: 40px; height: 34px; border-radius: 10px;
            display: flex; align-items: center; justify-content: center;
            color: var(--sub); transition: 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* ğŸ’¡ é€™é‚Šè§£æ±ºä½ èªªçš„ã€Œåº•è‰²é®®è‰·åº¦ã€ */
        .btn-icon.active {
            background: var(--indicator);
            color: #fff !important;
            box-shadow: 0 4px 15px rgba(0,0,0,0.15);
            transform: scale(1.08);
        }
        .dark-mode .btn-icon.active {
            color: #000 !important; /* é‡‘åº•é»‘å­— */
            border: 1.5px solid rgba(255,255,255,0.5);
        }

        .btn-circle {
            width: 42px; height: 42px; border-radius: 50%;
            background: var(--card); border: 1px solid var(--border);
            color: var(--text); display: flex; align-items: center; justify-content: center;
        }

        svg { width: 20px; height: 20px; fill: none; stroke: currentColor; stroke-width: 2.5; stroke-linecap: round; stroke-linejoin: round; }

        /* =============================================
           ğŸ“± 3. åˆ†é èˆ‡æ²å‹•å¼•æ“
           ============================================= */
        .viewport {
            width: 100%; height: calc(100dvh - 72px - 40px);
            display: flex; overflow-x: auto; overflow-y: hidden;
            scroll-snap-type: x mandatory; scrollbar-width: none;
            -webkit-overflow-scrolling: touch;
        }
        .viewport::-webkit-scrollbar { display: none; }

        .panel {
            flex: 0 0 100%; width: 100%; height: 100%;
            scroll-snap-align: start; overflow-y: auto;
            padding: 25px 20px 200px; box-sizing: border-box;
        }

        .grid { display: grid; gap: 18px; width: 100%; max-width: 1100px; margin: 0 auto; }
        
        [data-layout="list-mode"] .grid { grid-template-columns: 1fr; }
        @media (min-width: 768px) { [data-layout="list-mode"] .grid { grid-template-columns: repeat(2, 1fr); } }

        [data-layout="grid-mode"] .grid { grid-template-columns: repeat(3, 1fr); gap: 12px; }
        @media (min-width: 1024px) { [data-layout="grid-mode"] .grid { grid-template-columns: repeat(6, 1fr); } }

        /* å¡ç‰‡è¨­è¨ˆèˆ‡äº’å‹•ç¸®æ”¾ */
        .card {
            background: var(--card); border: 1px solid var(--border);
            border-radius: 24px; text-decoration: none; color: inherit;
            display: flex; transition: 0.3s; position: relative;
            box-shadow: 0 4px 6px rgba(0,0,0,0.02);
        }
        .card:active { transform: scale(0.95); background: var(--p-bg); }

        [data-layout="list-mode"] .card { padding: 22px; align-items: center; }
        [data-layout="grid-mode"] .card { flex-direction: column; padding: 20px 10px; text-align: center; aspect-ratio: 1/1.1; justify-content: center; }

        .c-icon { display: flex; align-items: center; justify-content: center; background: var(--p-bg); color: var(--p); }
        [data-layout="list-mode"] .c-icon { width: 56px; height: 56px; border-radius: 16px; margin-right: 20px; font-size: 24px; }
        [data-layout="grid-mode"] .c-icon { width: 48px; height: 48px; border-radius: 50%; margin: 0 auto 12px; font-size: 22px; }

        .c-txt h2 { margin: 0; font-size: 16px; font-weight: 850; }
        .c-txt p { margin: 4px 0 0; font-size: 12px; color: var(--sub); font-weight: 600; }
        [data-layout="grid-mode"] .c-txt p { display: none; }

        /* =============================================
           ğŸ§­ 4. åº•éƒ¨å›ºæ…‹å°è¦½
           ============================================= */
        .dock-container {
            position: fixed; bottom: calc(25px + var(--safe-bottom));
            left: 50%; transform: translateX(-50%); width: 92%; max-width: 440px; z-index: 5000;
        }
        .dock-glass {
            background: var(--nav); backdrop-filter: blur(30px) saturate(180%); -webkit-backdrop-filter: blur(30px) saturate(180%);
            display: flex; padding: 6px; border-radius: 100px;
            border: 1px solid var(--border); box-shadow: 0 15px 40px rgba(0,0,0,0.2);
        }
        .nav-item {
            flex: 1; text-align: center; padding: 14px 0; font-size: 14px;
            font-weight: 900; color: var(--sub); cursor: pointer;
            border-radius: 100px; transition: 0.4s cubic-bezier(0.2, 0.8, 0.2, 1);
        }
        .nav-item.active {
            color: #ffffff; background: var(--p);
            box-shadow: 0 8px 20px rgba(67, 97, 238, 0.3);
        }

        /* =============================================
           å½ˆçª—ä»‹é¢
           ============================================= */
        .overlay {
            position: fixed; inset: 0; background: rgba(0,0,0,0.85);
            backdrop-filter: blur(15px); -webkit-backdrop-filter: blur(15px);
            z-index: 9999; display: none; align-items: center; justify-content: center; padding: 25px;
        }
        .overlay.active { display: flex; }
        .modal {
            background: var(--bg); width: 100%; max-width: 360px;
            border-radius: 35px; overflow: hidden; border: 1px solid var(--border);
            animation: pop 0.4s cubic-bezier(0.17, 0.89, 0.32, 1.28);
        }
        @keyframes pop { from { opacity: 0; transform: scale(0.9) translateY(40px); } to { opacity: 1; transform: scale(1) translateY(0); } }
        .m-head { background: linear-gradient(135deg, var(--p), var(--g)); color: white; padding: 40px 25px; text-align: center; }
        .m-log { background: rgba(0,0,0,0.05); padding: 20px; border-radius: 20px; height: 150px; overflow-y: auto; font-size: 13px; line-height: 1.8; color: var(--sub); }

    </style>
</head>
<body data-layout="list-mode">

    <input type="range" id="haptic-trigger" style="position:fixed; left:-999px; opacity:0; pointer-events:none;">

    <div class="banner" id="ui-ann"></div>

    <header>
        <div class="brand">
            <h1>ç­ç´šæ•¸ä½å¹³å°</h1>
            <p>Classroom Sense Hub</p>
        </div>
        <div class="controls">
            <div class="sw-group">
                <button class="btn-icon" id="sw-list"><svg viewBox="0 0 24 24"><line x1="8" y1="6" x2="21" y2="6"/><line x1="8" y1="12" x2="21" y2="12"/><line x1="8" y1="18" x2="21" y2="18"/><path d="M3 6h.01M3 12h.01M3 18h.01"/></svg></button>
                <button class="btn-icon" id="sw-grid"><svg viewBox="0 0 24 24"><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/></svg></button>
            </div>
            <button class="btn-icon btn-circle" id="sw-theme"><svg id="svg-theme" viewBox="0 0 24 24"></svg></button>
            <button class="btn-icon btn-circle" id="sw-info"><svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><line x1="12" y1="16" x2="12" y2="12"/><line x1="12" y1="8" x2="12.01" y2="8"/></svg></button>
        </div>
    </header>

    <main class="viewport" id="scroller">
        <section class="panel"><div class="grid">
            <a href="è¡Œäº‹æ›†/index.html" class="card"><div class="c-icon">ğŸ“…</div><div class="c-txt"><h2>ç­ç´šè¡Œäº‹æ›†</h2><p>åŒæ­¥è€ƒç¨‹èˆ‡ç­ç´šæ´»å‹•æ—¥ç¨‹</p></div></a>
            <a href="countdown/index.html" class="card"><div class="c-icon">â³</div><div class="c-txt"><h2>è€ƒç¨‹å€’æ•¸</h2><p>æŒæ¡æ¯ä¸€ç§’é˜çš„æˆ°é¬¥ç¯€å¥</p></div></a>
            <a href="homework/index.html" class="card"><div class="c-icon">ğŸ“’</div><div class="c-txt"><h2>ä½œæ¥­å½™æ•´</h2><p>ä»Šæ—¥ä½œæ¥­æ¸…å–®èˆ‡æˆªæ­¢æé†’</p></div></a>
        </div></section>

        <section class="panel"><div class="grid">
            <a href="help/student.html" class="card"><div class="c-icon">ğŸŒ±</div><div class="c-txt"><h2>å¿ƒè²è«®è©¢</h2><p>å‚¾è½ä½ çš„å£“åŠ›èˆ‡æˆé•·é»æ»´</p></div></a>
            <a href="unknownmail/index.html" class="card"><div class="c-icon">ãŠ™ï¸</div><div class="c-txt"><h2>åŠ å¯†ä¿¡ç®±</h2><p>å®‰å…¨ä¸”åŒ¿åçš„ç§å¯†è¨Šæ¯æ¸ é“</p></div></a>
            <a href="åŒ¿å/index.html" class="card"><div class="c-icon">âœ¨</div><div class="c-txt"><h2>åŒ¿åè¨±é¡˜æ± </h2><p>æŠ•ä¸‹ä½ å°ç­ç´šçš„å„ç¨®é»å­</p></div></a>
        </div></section>

        <section class="panel"><div class="grid">
            <a href="cleaning/index.html" class="card"><div class="c-icon">ğŸ§¹</div><div class="c-txt"><h2>å‹¤å‹™è¿½è¹¤</h2><p>æ•´æ½”å€åŸŸèˆ‡è² è²¬äººæŸ¥è©¢</p></div></a>
            <a href="seating/index.html" class="card"><div class="c-icon">ğŸª‘</div><div class="c-txt"><h2>é¸ä½ç³»çµ±</h2><p>å…¬å¹³é€æ˜çš„æ•¸ä½æ›ä½æ©Ÿåˆ¶</p></div></a>
            <a href="vote/index.html" class="card"><div class="c-icon">ğŸ—³ï¸</div><div class="c-txt"><h2>æ•¸ä½æŠ•ç¥¨</h2><p>å…¨ç­å…¬å…±äº‹å‹™å³æ™‚è¡¨æ±º</p></div></a>
        </div></section>

        <section class="panel"><div class="grid">
            <a href="exam_calc/index.html" class="card"><div class="c-icon">ğŸ“</div><div class="c-txt"><h2>æ®µè€ƒåˆ†æ</h2><p>è¦–è¦ºåŒ–å€‹äººæˆç¸¾æ•¸æ“šå½™æ•´</p></div></a>
            <a href="final_calc/index.html" class="card"><div class="c-icon">ğŸ“ˆ</div><div class="c-txt"><h2>å­¸æœŸè©•ä¼°</h2><p>é ä¼°å­¸åˆ†èˆ‡å­¸æœŸå¹³å‡æ›²ç·š</p></div></a>
        </div></section>
    </main>

    <nav class="dock-container">
        <div class="dock-glass">
            <div class="nav-item">æé†’</div>
            <div class="nav-item">äº’å‹•</div>
            <div class="nav-item">ç­å‹™</div>
            <div class="nav-item">æˆç¸¾</div>
        </div>
    </nav>

    <div class="overlay" id="ui-modal">
        <div class="modal">
            <div class="m-head"><div style="font-size:30px; font-weight:900; margin-bottom:10px;">ç‹</div><h3 id="m-name" style="margin:0"></h3><p id="m-role" style="font-size:12px; opacity:0.8"></p></div>
            <div style="padding:25px;">
                <div style="display:flex; justify-content:space-between; margin-bottom:20px;"><span id="m-ver" style="background:var(--p); color:white; padding:5px 12px; border-radius:10px; font-size:12px; font-weight:800;"></span><a href="#" style="color:var(--p); font-weight:900; font-size:14px; text-decoration:none;">ğŸ“– æ•™å­¸æ‰‹å†Š</a></div>
                <div class="m-log" id="m-logs"></div>
                <button id="m-close" style="width:100%; padding:18px; background:var(--text); color:var(--bg); border:none; border-radius:20px; font-weight:900; margin-top:20px;">é—œé–‰è³‡è¨Š</button>
            </div>
        </div>
    </div>

    <script>
        /**
         * ğŸ æ——è‰¦ç‰ˆæ§åˆ¶å™¨ï¼šè¿½æ±‚æ¥µè‡´æ‰‹æ„Ÿèˆ‡ç©©å®š
         */
        const Hub = {
            state: {
                idx: parseInt(localStorage.getItem('page')) || 0,
                theme: localStorage.getItem('theme') || 'light',
                layout: localStorage.getItem('layout') || 'list-mode',
                isReady: false
            },

            // ğŸ“³ æ„Ÿå®˜é©…å‹•æ ¸å¿ƒ (åŒ…å«æ‹‰æ¡¿æ¨¡æ“¬)
            haptic: function(intensity = 'light') {
                // 1. å˜—è©¦å®˜æ–¹ Vibration API
                if (navigator.vibrate) {
                    const ms = intensity === 'light' ? 25 : 50;
                    navigator.vibrate(ms);
                }
                
                // 2. [æ ¸å¿ƒæ©Ÿåˆ¶] æ¨¡æ“¬åŸç”Ÿæ‹‰æ¡¿æ’¥å‹•ï¼Œèª˜ç™¼åº•å±¤ UI éœ‡å‹•å›é¥‹
                const trigger = document.getElementById('haptic-trigger');
                if (trigger) {
                    trigger.value = (parseInt(trigger.value) + 1) % 100;
                    trigger.dispatchEvent(new Event('input'));
                }
            },

            // ğŸš€ ä½ç½®æ§åˆ¶ (åŸåœ°é–å®š)
            jump: function(i, behavior = 'smooth') {
                if (behavior === 'smooth') this.haptic('light');
                const el = document.getElementById('scroller');
                el.scrollTo({ left: i * el.offsetWidth, behavior: behavior });
                this.state.idx = i;
                localStorage.setItem('page', i);
                this.syncNav();
            },

            // ğŸ¨ UI åŒæ­¥æ›´æ–°
            syncNav: function() {
                const items = document.querySelectorAll('.nav-item');
                items.forEach((t, i) => t.classList.toggle('active', i === this.state.idx));
            },

            setLayout: function(mode) {
                this.haptic('light');
                document.documentElement.setAttribute('data-layout', mode);
                this.state.layout = mode;
                localStorage.setItem('layout', mode);
                document.getElementById('sw-list').classList.toggle('active', mode === 'list-mode');
                document.getElementById('sw-grid').classList.toggle('active', mode === 'grid-mode');
                
                // æš´åŠ›é‡ç¹ªé˜²æ¶ˆå¤±
                this.forceRepaint();
                setTimeout(() => this.jump(this.state.idx, 'auto'), 50);
            },

            toggleTheme: function() {
                this.haptic('medium');
                this.state.theme = this.state.theme === 'light' ? 'dark' : 'light';
                document.documentElement.classList.toggle('dark-mode', this.state.theme === 'dark');
                localStorage.setItem('theme', this.state.theme);
                this.syncShell();
                this.forceRepaint();
            },

            syncShell: function() {
                const isDark = this.state.theme === 'dark';
                const color = isDark ? "#020617" : "#f8fafc";
                document.getElementById('meta-chrome').content = color;
                document.getElementById('meta-safari').content = isDark ? "black-translucent" : "default";
                
                const icon = document.getElementById('svg-theme');
                icon.innerHTML = isDark 
                    ? `<circle cx="12" cy="12" r="5" fill="currentColor"/><path d="M12 1v2m0 18v2M4.22 4.22l1.42 1.42m12.72 12.72l1.42 1.42M1 12h2m18 0h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42" stroke="currentColor"/>`
                    : `<path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z" fill="currentColor"/>`;
            },

            forceRepaint: function() {
                document.body.style.display = 'none';
                document.body.offsetHeight;
                document.body.style.display = 'block';
            },

            init: function() {
                // è¨­å®šå…¬å‘Š
                document.getElementById('ui-ann').innerText = APP_MANIFEST.announcement;

                // ç¶å®šæ‰€æœ‰äº‹ä»¶ç›£è½ (å–ä»£ onclick)
                document.querySelectorAll('.nav-item').forEach((btn, i) => {
                    btn.addEventListener('pointerdown', () => this.jump(i));
                });
                
                document.getElementById('sw-list').addEventListener('pointerdown', () => this.setLayout('list-mode'));
                document.getElementById('sw-grid').addEventListener('pointerdown', () => this.setLayout('grid-mode'));
                document.getElementById('sw-theme').addEventListener('pointerdown', () => this.toggleTheme());
                
                document.getElementById('sw-info').addEventListener('pointerdown', () => {
                    this.haptic('medium');
                    document.getElementById('m-name').innerText = APP_MANIFEST.author;
                    document.getElementById('m-role').innerText = "ç³»çµ±æ¶æ§‹å¸«";
                    document.getElementById('m-ver').innerText = APP_MANIFEST.version;
                    document.getElementById('m-logs').innerHTML = APP_MANIFEST.changelog.join('<br>');
                    document.getElementById('ui-modal').classList.add('active');
                });

                document.getElementById('m-close').addEventListener('pointerdown', () => {
                    document.getElementById('ui-modal').classList.remove('active');
                });

                // è¦–çª—å®šä½
                this.syncShell();
                this.syncNav();
                document.getElementById('sw-list').classList.toggle('active', this.state.layout === 'list-mode');
                document.getElementById('sw-grid').classList.toggle('active', this.state.layout === 'grid-mode');
                
                setTimeout(() => {
                    this.jump(this.state.idx, 'auto');
                    document.documentElement.setAttribute('data-ready', 'true');
                }, 100);

                // æ²å‹•ç›£è½
                document.getElementById('scroller').addEventListener('scroll', () => {
                    const el = document.getElementById('scroller');
                    const i = Math.round(el.scrollLeft / el.offsetWidth);
                    if (i !== this.state.idx) {
                        this.state.idx = i;
                        localStorage.setItem('page', i);
                        this.syncNav();
                    }
                }, { passive: true });
            }
        };

        // å•Ÿå‹•å…¥å£
        window.addEventListener('DOMContentLoaded', () => Hub.init());
        window.addEventListener('resize', () => Hub.jump(Hub.state.idx, 'auto'));
    </script>
</body>
</html>
