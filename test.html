<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>ç­ç´šæ•¸ä½å¹³å° v3.3.0</title>

    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" id="safari-theme" content="default">
    <meta name="theme-color" id="chrome-theme" content="#f8fafc">

    <script>
        /** ğŸ ä¿ç•™æ‚¨çš„å•Ÿå‹•å‰ç½®é‚è¼¯ */
        (function() {
            const theme = localStorage.getItem('theme') || 'light';
            const layout = localStorage.getItem('layout') || 'list-mode';
            const lastPage = localStorage.getItem('lastPage') || '0';

            if (theme === 'dark') document.documentElement.classList.add('dark-mode');
            document.documentElement.setAttribute('data-layout', layout);
            document.documentElement.setAttribute('data-init-page', lastPage);
            
            const gateStyle = document.createElement('style');
            gateStyle.innerHTML = `body { opacity: 0; } [data-system-ready="true"] body { opacity: 1; transition: opacity 0.3s ease; }`;
            document.head.appendChild(gateStyle);
        })();

        const SYS_CONFIG = {
            banner: "è¨±é¡˜æ± ç³»çµ±è² è¼‰è¼ƒé«˜ï¼Œè«‹ç¯€çœé »ç‡ä»¥ç¶­æŒå…¶ä»–æœå‹™æ­£å¸¸ã€‚",
            author: { name: "ç‹å®¥éˆ", role: "é–‹ç™¼è€…", ver: "v3.3.0" }
        };
    </script>

    <style>
        /* ğŸ¨ 1. å®Œå…¨ä¿ç•™æ‚¨çš„è®Šæ•¸ç³»çµ± */
        :root {
            --p: #4361ee; --p-light: rgba(67, 97, 238, 0.1); --g: #7209b7; 
            --bg: #f8fafc; --card: #ffffff; --text: #1e293b; --sub: #64748b; 
            --border: rgba(0,0,0,0.08); --nav-bg: rgba(255, 255, 255, 0.85); 
            --accent: #4361ee; --safe-top: env(safe-area-inset-top, 20px);
            --safe-bottom: env(safe-area-inset-bottom, 20px);
        }

        .dark-mode {
            --bg: #020617; --card: #111827; --text: #f8fafc; --sub: #94a3b8; 
            --border: rgba(255,255,255,0.1); --nav-bg: rgba(15, 23, 42, 0.85); 
            --accent: #fbbf24;
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body {
            margin: 0; padding: 0; width: 100vw; height: 100dvh;
            background-color: var(--bg); color: var(--text);
            font-family: 'PingFang TC', 'Microsoft JhengHei', system-ui, sans-serif;
            overflow: hidden; position: fixed;
        }

        /* ğŸ“¢ é ‚éƒ¨å…¬å‘Šèˆ‡å°è¦½ (é©é…æ‰‹æ©Ÿé«˜åº¦) */
        .top-notice {
            background: var(--banner-bg); color: var(--banner-text);
            padding: calc(var(--safe-top) / 2 + 5px) 15px 5px; font-size: 12px; 
            text-align: center; font-weight: 700; border-bottom: 1px solid var(--border);
        }

        header {
            height: 72px; padding: 0 20px;
            background: var(--nav-bg); backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px);
            border-bottom: 1px solid var(--border);
            display: flex; justify-content: space-between; align-items: center; z-index: 1000;
        }

        .brand h1 { margin: 0; font-size: 20px; font-weight: 900; color: var(--p); }
        .brand p { margin: 0; font-size: 10px; color: var(--sub); font-weight: 800; text-transform: uppercase; }

        /* ğŸ•¹ï¸ æŒ‰éˆ•æ§åˆ¶å™¨ (ä¿ç•™ SVG èˆ‡ Active é‚è¼¯) */
        .controls { display: flex; gap: 8px; }
        .toggle-group { display: flex; background: rgba(0,0,0,0.05); padding: 4px; border-radius: 12px; }
        .icon-btn {
            border: none; background: transparent; width: 36px; height: 32px; border-radius: 8px;
            display: flex; align-items: center; justify-content: center; color: var(--sub); transition: all 0.2s;
        }
        .icon-btn.active { background: var(--p); color: #fff !important; }
        .dark-mode .icon-btn.active { background: var(--accent); color: #000 !important; }
        .circle-tool { width: 38px; height: 38px; border-radius: 50%; border: 1px solid var(--border); background: var(--card); }
        svg { width: 18px; height: 18px; fill: none; stroke: currentColor; stroke-width: 2.5; }

        /* ğŸ“– ä¸»å…§å®¹å®¹å™¨ */
        .viewport {
            width: 100%; height: calc(100dvh - 72px - 100px);
            display: flex; overflow-x: auto; scroll-snap-type: x mandatory;
            scrollbar-width: none; -webkit-overflow-scrolling: touch;
        }
        .viewport::-webkit-scrollbar { display: none; }
        .page-panel { flex: 0 0 100%; width: 100%; height: 100%; scroll-snap-align: start; overflow-y: auto; padding: 20px 20px 150px; }

        /* ğŸƒ å¡ç‰‡ä½ˆå±€ (å®Œå…¨ä¿ç•™æ‚¨çš„åŸæœ¬è¨­è¨ˆ) */
        .content-grid { display: grid; gap: 16px; width: 100%; }
        [data-layout="list-mode"] .card { padding: 22px; display: flex; align-items: center; }
        [data-layout="grid-mode"] .content-grid { grid-template-columns: repeat(3, 1fr); gap: 10px; }
        [data-layout="grid-mode"] .card { flex-direction: column; padding: 15px 5px; text-align: center; }

        .card { background: var(--card); border: 1px solid var(--border); border-radius: 24px; color: inherit; transition: 0.2s; cursor: pointer; }
        .card:active { transform: scale(0.96); background: var(--p-light); }
        .card-icon { 
            display: flex; align-items: center; justify-content: center; background: var(--p-light); color: var(--p); 
            width: 50px; height: 50px; border-radius: 14px; font-size: 22px;
        }
        [data-layout="list-mode"] .card-icon { margin-right: 18px; }
        [data-layout="grid-mode"] .card-icon { margin-bottom: 10px; width: 42px; height: 42px; border-radius: 50%; }
        .card-info h2 { margin: 0; font-size: 15px; font-weight: 800; }
        .card-info p { margin: 4px 0 0; font-size: 11px; color: var(--sub); }
        [data-layout="grid-mode"] .card-info p { display: none; }

        /* ğŸ§­ åº•éƒ¨å°è¦½ (è§£æ±º App éŒ¯ä½) */
        .nav-dock { position: fixed; bottom: calc(20px + var(--safe-bottom)); left: 50%; transform: translateX(-50%); width: 92%; max-width: 440px; z-index: 5000; }
        .nav-glass { background: var(--nav-bg); backdrop-filter: blur(25px); display: flex; padding: 5px; border-radius: 100px; border: 1px solid var(--border); box-shadow: 0 10px 30px rgba(0,0,0,0.15); }
        .nav-item { flex: 1; text-align: center; padding: 12px 0; font-size: 13px; font-weight: 900; color: var(--sub); border-radius: 100px; }
        .nav-item.active { color: #fff; background: var(--p); }

        /* ğŸ“º æ²‰æµ¸å¼å·¥å…·æª¢è¦–å™¨ (æ ¸å¿ƒï¼šé˜²ç¶²å€åˆ—è·³å‡º) */
        #tool-container {
            position: fixed; inset: 0; background: var(--bg); z-index: 9999;
            transform: translateY(100%); transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex; flex-direction: column;
        }
        #tool-container.active { transform: translateY(0); }
        .tool-header {
            padding: calc(var(--safe-top) + 10px) 20px 10px;
            background: var(--card); border-bottom: 1px solid var(--border);
            display: flex; align-items: center; justify-content: space-between;
        }
        iframe { flex: 1; border: none; width: 100%; height: 100%; }
    </style>
</head>
<body data-layout="list-mode">

    <div class="top-notice" id="ui-banner"></div>

    <header>
        <div class="brand"><h1>ç­ç´šæ•¸ä½å¹³å°</h1><p>Digital Classroom System</p></div>
        <div class="controls">
            <div class="toggle-group">
                <button class="icon-btn" id="listToggle" onclick="Hub.updateLayout('list-mode')"><svg viewBox="0 0 24 24"><line x1="8" y1="6" x2="21" y2="6"/><line x1="8" y1="12" x2="21" y2="12"/><line x1="8" y1="18" x2="21" y2="18"/><path d="M3 6h.01M3 12h.01M3 18h.01"/></svg></button>
                <button class="icon-btn" id="gridToggle" onclick="Hub.updateLayout('grid-mode')"><svg viewBox="0 0 24 24"><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/></svg></button>
            </div>
            <button class="icon-btn circle-tool" onclick="Hub.updateTheme()"><svg id="theme-icon" viewBox="0 0 24 24"></svg></button>
        </div>
    </header>

    <main class="viewport" id="scroll-engine">
        <section class="page-panel"><div class="content-grid">
            <div class="card" onclick="Hub.openTool('calendar/index.html', 'ç­ç´šè¡Œäº‹æ›†')"><div class="card-icon">ğŸ“…</div><div class="card-info"><h2>ç­ç´šè¡Œäº‹æ›†</h2><p>æŒæ¡è€ƒç¨‹èˆ‡é‡è¦æ´»å‹•</p></div></div>
            <div class="card" onclick="Hub.openTool('homework/index.html', 'ä½œæ¥­å¾…è¾¦')"><div class="card-icon">ğŸ“’</div><div class="card-info"><h2>ä½œæ¥­å¾…è¾¦</h2><p>åŒå­¸å³æ™‚æŸ¥çœ‹ä¸éºæ¼</p></div></div>
        </div></section>
        
        <section class="page-panel"><div class="content-grid">
            <div class="card" onclick="Hub.openTool('unknownmail/index.html', 'åŒ¿åä¿¡ç®±')"><div class="card-icon">âœ‰ï¸</div><div class="card-info"><h2>åŒ¿åä¿¡ç®±</h2><p>åŒ¿åå‚³é€æé†’çµ¦åŒå­¸</p></div></div>
            <div class="card" onclick="Hub.openTool('board/index.html', 'ç•™è¨€æ¿')"><div class="card-icon">ğŸ’¬</div><div class="card-info"><h2>å¯¦åç•™è¨€æ¿</h2><p>ç•™ä¸‹æƒ³èªªçš„è©±</p></div></div>
        </div></section>
        
        <section class="page-panel"><div class="content-grid">
            <div class="card" onclick="Hub.openTool('seating/index.html', 'é¸ä½ç³»çµ±')"><div class="card-icon">ğŸª‘</div><div class="card-info"><h2>é¸ä½ç³»çµ±</h2><p>éš¨æ©Ÿç”Ÿæˆåº§ä½è¡¨</p></div></div>
            <div class="card" onclick="Hub.openTool('vote/index.html', 'æ•¸ä½æŠ•ç¥¨')"><div class="card-icon">ğŸ—³ï¸</div><div class="card-info"><h2>æ•¸ä½æŠ•ç¥¨</h2><p>å³æ™‚è¡¨æ±ºç­ç´šäº‹å‹™</p></div></div>
        </div></section>

        <section class="page-panel"><div class="content-grid">
            <div class="card" onclick="Hub.openTool('exam_calc/index.html', 'æ®µè€ƒåŠ æ¬Š')"><div class="card-icon">ğŸ“</div><div class="card-info"><h2>æ®µè€ƒåŠ æ¬Š</h2><p>è¨ˆç®—å¹³å‡èˆ‡ç¸½åˆ†</p></div></div>
        </div></section>
    </main>

    <nav class="nav-dock">
        <div class="nav-glass">
            <div class="nav-item" onclick="Hub.moveTo(0)">æé†’</div>
            <div class="nav-item" onclick="Hub.moveTo(1)">äº’å‹•</div>
            <div class="nav-item" onclick="Hub.moveTo(2)">ç­å‹™</div>
            <div class="nav-item" onclick="Hub.moveTo(3)">æˆç¸¾</div>
        </div>
    </nav>

    <div id="tool-container">
        <div class="tool-header">
            <button class="icon-btn" onclick="Hub.closeTool()" style="width: auto; padding: 0 15px; font-weight: 800; color: var(--p);">âœ• é—œé–‰</button>
            <div id="tool-title" style="font-weight: 800;"></div>
            <div style="width: 60px;"></div> </div>
        <iframe id="tool-iframe" src=""></iframe>
    </div>

    <script>
        const Hub = {
            state: {
                currentIdx: parseInt(localStorage.getItem('lastPage')) || 0,
                isDark: document.documentElement.classList.contains('dark-mode'),
                layout: localStorage.getItem('layout') || 'list-mode'
            },
            
            init() {
                document.getElementById('ui-banner').innerText = SYS_CONFIG.banner;
                this.updateLayout(this.state.layout);
                this.syncThemeUI();
                setTimeout(() => {
                    this.moveTo(this.state.currentIdx, 'auto');
                    document.documentElement.setAttribute('data-system-ready', 'true');
                }, 50);
                this.bindEvents();
            },

            moveTo(idx, behavior = 'smooth') {
                const scroller = document.getElementById('scroll-engine');
                scroller.scrollTo({ left: idx * scroller.offsetWidth, behavior });
                this.state.currentIdx = idx;
                localStorage.setItem('lastPage', idx);
                this.updateNavUI();
            },

            updateNavUI() {
                document.querySelectorAll('.nav-item').forEach((tab, i) => {
                    tab.classList.toggle('active', i === this.state.currentIdx);
                });
            },

            updateLayout(mode) {
                document.documentElement.setAttribute('data-layout', mode);
                this.state.layout = mode;
                localStorage.setItem('layout', mode);
                document.getElementById('listToggle').classList.toggle('active', mode === 'list-mode');
                document.getElementById('gridToggle').classList.toggle('active', mode === 'grid-mode');
                setTimeout(() => this.moveTo(this.state.currentIdx, 'auto'), 60);
            },

            updateTheme() {
                this.state.isDark = !this.state.isDark;
                document.documentElement.classList.toggle('dark-mode', this.state.isDark);
                localStorage.setItem('theme', this.state.isDark ? 'dark' : 'light');
                this.syncThemeUI();
            },

            syncThemeUI() {
                const color = this.state.isDark ? "#020617" : "#f8fafc";
                document.getElementById('chrome-theme').content = color;
                document.getElementById('safari-theme').content = this.state.isDark ? "black-translucent" : "default";
                document.getElementById('theme-icon').innerHTML = this.state.isDark 
                    ? `<circle cx="12" cy="12" r="5" fill="currentColor"/><path d="M12 1v2m0 18v2M4.22 4.22l1.42 1.42m12.72 12.72l1.42 1.42M1 12h2m18 0h2" stroke="currentColor"/>`
                    : `<path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z" fill="currentColor" stroke="currentColor"/>`;
            },

            openTool(url, title) {
                const container = document.getElementById('tool-container');
                document.getElementById('tool-title').innerText = title;
                document.getElementById('tool-iframe').src = url;
                container.classList.add('active');
            },

            closeTool() {
                document.getElementById('tool-container').classList.remove('active');
                setTimeout(() => { document.getElementById('tool-iframe').src = ''; }, 400);
            },

            bindEvents() {
                const scroller = document.getElementById('scroll-engine');
                scroller.addEventListener('scroll', () => {
                    const newIdx = Math.round(scroller.scrollLeft / scroller.offsetWidth);
                    if (newIdx !== this.state.currentIdx) {
                        this.state.currentIdx = newIdx;
                        localStorage.setItem('lastPage', newIdx);
                        this.updateNavUI();
                    }
                }, { passive: true });
                window.addEventListener('resize', () => this.moveTo(this.state.currentIdx, 'auto'));
            }
        };

        window.addEventListener('DOMContentLoaded', () => Hub.init());
    </script>
</body>
</html>
